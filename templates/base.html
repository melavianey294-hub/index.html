<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Hotel - CRUD Clientes y Reservas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <!-- Bootstrap 5.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,.075);
        }
        .form-control, .form-select {
            border-radius: 0.375rem;
        }
        .section-title {
            font-weight: 600;
            margin-bottom: 1rem;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 0.5rem;
        }
        .btn i {
            margin-right: 4px;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4 shadow">
    <div class="container">
        <a class="navbar-brand" href="#">Hotel CRUD</a>
        <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link active" href="#clientes">Clientes</a></li>
            <li class="nav-item"><a class="nav-link" href="#reservas">Reservas</a></li>
        </ul>
    </div>
</nav>

<div class="container mb-5">
    <!-- CLIENTES -->
    <section id="clientes" class="mb-5">
        <div class="card p-4">
            <h2 class="section-title">Clientes</h2>

            <form id="clienteForm" class="row g-3 mb-4">
                <input type="hidden" id="clienteId" />
                <div class="col-md-4">
                    <input type="text" class="form-control" id="nombre" placeholder="Nombre completo" required />
                </div>
                <div class="col-md-4">
                    <input type="email" class="form-control" id="correo" placeholder="Correo electrónico" required />
                </div>
                <div class="col-md-3">
                    <input type="text" class="form-control" id="telefono" placeholder="Teléfono" required />
                </div>
                <div class="col-md-1 d-grid">
                    <button type="submit" class="btn btn-success"><i class="bi bi-save"></i>Guardar</button>
                </div>
            </form>

            <div class="table-responsive">
                <table class="table table-hover table-bordered align-middle">
                    <thead class="table-primary">
                        <tr>
                            <th>Nombre</th>
                            <th>Correo</th>
                            <th>Teléfono</th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="clienteTabla"></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- RESERVAS -->
    <section id="reservas">
        <div class="card p-4">
            <h2 class="section-title">Reservas</h2>

            <form id="reservaForm" class="row g-3 mb-4">
                <input type="hidden" id="reservaId" />
                <div class="col-md-3">
                    <select id="reservaCliente" class="form-select" required>
                        <option value="">Seleccionar cliente</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <input type="date" class="form-control" id="fechaEntrada" required />
                </div>
                <div class="col-md-2">
                    <input type="date" class="form-control" id="fechaSalida" required />
                </div>
                <div class="col-md-3">
                    <input type="text" class="form-control" id="habitacion" placeholder="Habitación" required />
                </div>
                <div class="col-md-2 d-grid">
                    <button type="submit" class="btn btn-success"><i class="bi bi-save"></i>Guardar</button>
                </div>
            </form>

            <div class="table-responsive">
                <table class="table table-hover table-bordered align-middle">
                    <thead class="table-primary">
                        <tr>
                            <th>Cliente</th>
                            <th>Entrada</th>
                            <th>Salida</th>
                            <th>Habitación</th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="reservaTabla"></tbody>
                </table>
            </div>
        </div>
    </section>
</div>

<!-- Scripts -->
<script>
    let clientes = [];
    let reservas = [];
    let clienteIdCounter = 1;
    let reservaIdCounter = 1;

    const clienteForm = document.getElementById('clienteForm');
    const clienteTabla = document.getElementById('clienteTabla');
    const reservaClienteSelect = document.getElementById('reservaCliente');
    const reservaForm = document.getElementById('reservaForm');
    const reservaTabla = document.getElementById('reservaTabla');

    // -------- CRUD Clientes --------

    clienteForm.addEventListener('submit', e => {
        e.preventDefault();

        const id = document.getElementById('clienteId').value;
        const nombre = document.getElementById('nombre').value.trim();
        const correo = document.getElementById('correo').value.trim();
        const telefono = document.getElementById('telefono').value.trim();

        if (!nombre || !correo || !telefono) {
            alert('Por favor, completa todos los campos.');
            return;
        }

        if (id) {
            // Editar cliente
            const cliente = clientes.find(c => c.id == id);
            if (cliente) {
                cliente.nombre = nombre;
                cliente.correo = correo;
                cliente.telefono = telefono;
            }
        } else {
            // Crear cliente
            clientes.push({ id: clienteIdCounter++, nombre, correo, telefono });
        }

        clienteForm.reset();
        document.getElementById('clienteId').value = '';
        renderClientes();
        renderClientesSelect();
    });

    function renderClientes() {
        clienteTabla.innerHTML = '';
        clientes.forEach(c => {
            clienteTabla.innerHTML += `
                <tr>
                    <td>${c.nombre}</td>
                    <td>${c.correo}</td>
                    <td>${c.telefono}</td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-warning me-2" onclick="editarCliente(${c.id})"><i class="bi bi-pencil-square"></i>Editar</button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarCliente(${c.id})"><i class="bi bi-trash"></i>Eliminar</button>
                    </td>
                </tr>`;
        });
    }

    function editarCliente(id) {
        const cliente = clientes.find(c => c.id === id);
        if (cliente) {
            document.getElementById('clienteId').value = cliente.id;
            document.getElementById('nombre').value = cliente.nombre;
            document.getElementById('correo').value = cliente.correo;
            document.getElementById('telefono').value = cliente.telefono;
        }
    }

    function eliminarCliente(id) {
        if (!confirm('¿Estás seguro de eliminar este cliente y sus reservas?')) return;
        clientes = clientes.filter(c => c.id !== id);
        reservas = reservas.filter(r => r.clienteId !== id);
        renderClientes();
        renderClientesSelect();
        renderReservas();
    }

    function renderClientesSelect() {
        reservaClienteSelect.innerHTML = '<option value="">Seleccionar cliente</option>';
        clientes.forEach(c => {
            reservaClienteSelect.innerHTML += `<option value="${c.id}">${c.nombre}</option>`;
        });
    }

    // -------- CRUD Reservas --------

    reservaForm.addEventListener('submit', e => {
        e.preventDefault();

        const id = document.getElementById('reservaId').value;
        const clienteId = parseInt(document.getElementById('reservaCliente').value);
        const fechaEntrada = document.getElementById('fechaEntrada').value;
        const fechaSalida = document.getElementById('fechaSalida').value;
        const habitacion = document.getElementById('habitacion').value.trim();

        if (!clienteId || !fechaEntrada || !fechaSalida || !habitacion) {
            alert('Por favor, completa todos los campos.');
            return;
        }

        if (new Date(fechaEntrada) > new Date(fechaSalida)) {
            alert('La fecha de entrada no puede ser mayor que la fecha de salida.');
            return;
        }

        if (id) {
            // Editar reserva
            const reserva = reservas.find(r => r.id == id);
            if (reserva) {
                reserva.clienteId = clienteId;
                reserva.fechaEntrada = fechaEntrada;
                reserva.fechaSalida = fechaSalida;
                reserva.habitacion = habitacion;
            }
        } else {
            // Crear reserva
            reservas.push({
                id: reservaIdCounter++,
                clienteId,
                fechaEntrada,
                fechaSalida,
                habitacion
            });
        }

        reservaForm.reset();
        document.getElementById('reservaId').value = '';
        renderReservas();
    });

    function renderReservas() {
        reservaTabla.innerHTML = '';
        reservas.forEach(r => {
            const cliente = clientes.find(c => c.id === r.clienteId);
            reservaTabla.innerHTML += `
                <tr>
                    <td>${cliente ? cliente.nombre : 'Desconocido'}</td>
                    <td>${r.fechaEntrada}</td>
                    <td>${r.fechaSalida}</td>
                    <td>${r.habitacion}</td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-warning me-2" onclick="editarReserva(${r.id})"><i class="bi bi-pencil-square"></i>Editar</button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarReserva(${r.id})"><i class="bi bi-trash"></i>Eliminar</button>
                    </td>
                </tr>`;
        });
    }

    function editarReserva(id) {
        const reserva = reservas.find(r => r.id === id);
        if (reserva) {
            document.getElementById('reservaId').value = reserva.id;
            document.getElementById('reservaCliente').value = reserva.clienteId;
            document.getElementById('fechaEntrada').value = reserva.fechaEntrada;
            document.getElementById('fechaSalida').value = reserva.fechaSalida;
            document.getElementById('habitacion').value = reserva.habitacion;
        }
    }

    function eliminarReserva(id) {
        if (!confirm('¿Estás seguro de eliminar esta reserva?')) return;
        reservas = reservas.filter(r => r.id !== id);
        renderReservas();
    }

    // Inicialización
    renderClientes();
    renderClientesSelect();
    renderReservas();
</script>

</body>
</html>
